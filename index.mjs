// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-error@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-buffer@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-copy@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-inherit@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-property@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/buffer-from-string@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/buffer-ctor@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/string-format@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-next-tick@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-number@esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@esm/index.mjs";function v(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})})),t}var w="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function y(){throw new Error("setTimeout has not been defined")}function x(){throw new Error("clearTimeout has not been defined")}var _=y,T=x;function M(e){if(_===setTimeout)return setTimeout(e,0);if((_===y||!_)&&setTimeout)return _=setTimeout,setTimeout(e,0);try{return _(e,0)}catch(t){try{return _.call(null,e,0)}catch(t){return _.call(this,e,0)}}}"function"==typeof w.setTimeout&&(_=setTimeout),"function"==typeof w.clearTimeout&&(T=clearTimeout);var E,O=[],k=!1,z=-1;function P(){k&&E&&(k=!1,E.length?O=E.concat(O):z=-1,O.length&&S())}function S(){if(!k){var e=M(P);k=!0;for(var t=O.length;t;){for(E=O,O=[];++z<t;)E&&E[z].run();z=-1,t=O.length}E=null,k=!1,function(e){if(T===clearTimeout)return clearTimeout(e);if((T===x||!T)&&clearTimeout)return T=clearTimeout,clearTimeout(e);try{T(e)}catch(t){try{return T.call(null,e)}catch(t){return T.call(this,e)}}}(e)}}function N(e,t){this.fun=e,this.array=t}N.prototype.run=function(){this.fun.apply(null,this.array)};function W(){}var q=W,D=W,R=W,V=W,A=W,L=W,J=W;var F=w.performance||{},B=F.now||F.mozNow||F.msNow||F.oNow||F.webkitNow||function(){return(new Date).getTime()};var C=new Date;var I={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];O.push(new N(e,t)),1!==O.length||k||M(S)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:q,addListener:D,once:R,off:V,removeListener:A,removeAllListeners:L,emit:J,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*B.call(F),r=Math.floor(t),i=Math.floor(t%1*1e9);return e&&(r-=e[0],(i-=e[1])<0&&(r--,i+=1e9)),[r,i]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-C)/1e3}},G=require("stream");"disable"===I.env.READABLE_STREAM&&G?(module.exports=G,exports=module.exports=G.Readable,exports.Readable=G.Readable,exports.Writable=G.Writable,exports.Duplex=G.Duplex,exports.Transform=G.Transform,exports.PassThrough=G.PassThrough,exports.Stream=G):(exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=G||exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"));var H=v(Object.freeze({__proto__:null})),K={objectMode:!1,encoding:null,sep:"\n"},Q=p,U=f,X=c.isPrimitive,Y=g.isPrimitive,Z=b.isPrimitive,$=j,ee=m;var te=function(e,t){return Q(t)?U(t,"sep")&&(e.sep=t.sep,!Z(e.sep))?new TypeError(ee("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):U(t,"objectMode")&&(e.objectMode=t.objectMode,!X(e.objectMode))?new TypeError(ee("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):U(t,"encoding")&&(e.encoding=t.encoding,!Z(e.encoding)&&null!==e.encoding)?new TypeError(ee("invalid option. `%s` option must be a string or null. Option: `%s`.","encoding",e.encoding)):U(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Y(e.highWaterMark))?new TypeError(ee("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):U(t,"serialize")&&(e.serialize=t.serialize,!$(e.serialize))?new TypeError(ee("invalid option. `%s` option must be a function. Option: `%s`.","serialize",e.serialize)):null:new TypeError(ee("invalid argument. Options argument must be an object. Value: `%s`.",t))};module.exports=void 0!==I&&"renderer"===I.type?require("./browser.js"):require("./node.js");var re=v(Object.freeze({__proto__:null}))("from-strided-array-stream"),ie=H.Readable,se=t,ne=r,oe=i,ae=s.isPrimitive,de=n.isPrimitive,le=o,ue=d,me=e,he=l,pe=u,fe=m,ce=h,ge=K,be=te,je=re;function ve(e,t,r,i,s){var n,o,a;if(!(this instanceof ve))return arguments.length>4?new ve(e,t,r,i,s):new ve(e,t,r,i);if(!de(e))throw new TypeError(fe("invalid argument. First argument must be a nonnegative integer. Value: `%s`.",e));if(!se(t))throw new TypeError(fe("invalid argument. Second argument must be an array-like object. Value: `%s`.",t));if(!ae(r))throw new TypeError(fe("invalid argument. Third argument must be an integer. Value: `%s`.",r));if(!de(i))throw new TypeError(fe("invalid argument. Fourth argument must be a nonnegative integer. Value: `%s`.",i));if(e>0&&(a=i+(e-1)*r,i>=t.length||a<0||a>=t.length))throw new RangeError("invalid arguments. Strided array parameters are incompatible with the provided array-like object. Linear index exceeds array bounds.");if(n=le(ge),arguments.length>4&&(o=be(n,s)))throw o;return je("Creating a readable stream configured with the following options: %s.",JSON.stringify(n)),ie.call(this,n),ue(this,"_destroyed",!1),me(this,"_objectMode",n.objectMode),me(this,"_sep",n.sep),me(this,"_serialize",n.serialize||JSON.stringify),me(this,"_buffer",t),me(this,"_N",e),me(this,"_stride",r),me(this,"_offset",i),ue(this,"_idx",i),ue(this,"_i",0),this}a(ve,ie),me(ve.prototype,"_read",(function(){var e,t,r;if(!this._destroyed)for(e=!0;e;){if(t=null,this._i+=1,this._i>this._N)return je("Finished iteration."),this.push(null);r=this._buffer[this._idx],je("Value: %s. Idx: %d. Iter: %d.",JSON.stringify(r),this._idx,this._i),this._idx+=this._stride,!1===this._objectMode&&("string"==typeof(r=this._serialize(r))?r=1===this._i?he(r):he(this._sep+r):oe(r)?this._i>1&&(r=pe.concat([he(this._sep),r])):t=new Error(fe("invalid operation. Serialization function must return a string or Buffer. Value: `%s`.",r))),t?this.emit("error",t):e=this.push(r)}})),me(ve.prototype,"destroy",(function(e){var t;return this._destroyed?(je("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,ce((function(){e&&(je("Stream was destroyed due to an error. Error: %s.",ne(e)?e.message:JSON.stringify(e)),t.emit("error",e));je("Closing the stream..."),t.emit("close")})),this)}));var we=p,ye=m,xe=o,_e=ve;var Te=o,Me=ve;var Ee=e,Oe=ve,ke=function(e,t,r,i,s){var n;if(arguments.length>4){if(!we(n=s))throw new TypeError(ye("invalid argument. Options argument must be an object. Value: `%s`.",n));n=xe(s,1)}else n={};return n.objectMode=!0,new _e(e,t,r,i,n)},ze=function(e){var t;return t=arguments.length?Te(e,1):{},r;function r(e,r,i,s){return new Me(e,r,i,s,t)}};Ee(Oe,"objectMode",ke),Ee(Oe,"factory",ze);var Pe=Oe;export{Pe as default,ze as factory,ke as objectMode};
//# sourceMappingURL=index.mjs.map
